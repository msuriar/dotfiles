current_branch() {
  =git branch --no-color 2> /dev/null | awk '/\*/ { print $2 }'
}

last_commit_time() {
  =git log -1 --pretty=format:%at
}

repo_dirty() {
  [[ -n $(=git status --short) ]]
}

zsh_update_git_params() {
  export VCS_BRANCH=$(current_branch)
  export VCS_LAST_COMMIT_TIME=$(last_commit_time)
  if repo_dirty ; then
    VCS_REPO_DIRTY=1
  else
    unset VCS_REPO_DIRTY
  fi
}

in_git_repo() {
  =git branch --quiet 1> /dev/null 2>&1
}
